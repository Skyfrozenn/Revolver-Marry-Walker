<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Профиль</title>
    <style>
        .avatar {
            width: 250px;         /* Нормальный размер как в соцсетях */
            height: 250px;        /* Квадратная форма */
            object-fit: cover;    /* Чтобы изображение заполняло круг */
            box-shadow: 0 0 10px rgba(0,0,0,0.3); /* Легкая тень */
            display: block;
        }
        
        .default-avatar {
            width: 250px;
            height: 250px;
            object-fit: cover;
            border: 3px solid #ccc;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            display: block;
        }
        
        /* Стиль для флеш сообщения - белый текст в черной рамке */
        .flash-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white; /* Белый текст */
            background-color: black; /* Черный фон */
            padding: 20px 40px;
            border: 2px solid black; /* Черная рамка */
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            z-index: 1000;
            animation: fadeInOut 5s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Вывод флеш сообщений -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            {% for message in messages %}
                <div class="flash-message">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <h1>Revolver Marry Walker</h1><br>
    <a href="{{url_for('home_page')}}">Выйти</a><br><br>
    <a href="{{url_for('watch_cards')}}">Постеры</a><br><br>
    <a href="{{url_for('all_category')}}">Товары</a> <br><br>
    
    {% if current_user.role == "Creator" or current_user.role == "Admin"  %}
        <a href="{{url_for('watch_cards_page')}}">Добавить товар</a>
    {% endif %}
    <br><br>
    <a href="{{url_for('cart_user_card')}}">Корзина</a><br><br>
    {% if current_user.role == "Creator" or current_user.role == "Admin"  %}
        <a href="{{url_for('state')}}">Статистика</a>
    {% endif %}

    <hr>
    
    {% if user.photo_uploads %}
         <img class="avatar" src="data:image/*;base64,{{ user.photo_uploads }}" alt="Profile Picture">
    {% else %}
        <img class="default-avatar" 
             src="https://avatars.mds.yandex.net/i?id=503c6934742d3ca332d383687581e5b3_l-5668549-images-thumbs&n=13" 
             alt="Аватарка по умолчанию">
    {% endif %}
    <br>
    <form action="/uploads_photo" method="post" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value = "{{ csrf_token()}}" >
        <input type="file" name="photo" accept="image/*" required>
        <button type="submit">Изменить фото</button>
    </form>
    <hr>

    <b>{{user.name}}</b> <b>({{user.role}})</b><br><br>
    Дата регистрации : {{user.join}} <br><br>
    {% if count is not none %}
        Количество купленных товаров : {{count}}
    {% else %}
        Количество купленных товаров : 0
    {% endif %}
    
    <!-- Скрипт для автоматического скрытия флеш сообщения -->
    <script>
         <!-- Скрипт для автоматического скрытия флеш сообщений -->
     
             document.addEventListener('DOMContentLoaded', function() {
            const flashMessages = document.querySelectorAll('.flash-message');
            flashMessages.forEach((message, index) => {
                // Добавляем задержку для каждого сообщения, чтобы они не накладывались
                setTimeout(() => {
                    message.style.display = 'none';
                    message.remove()
                }, 3000 + (index * 100));
                 // 3 секунды + небольшая задержка между сообщениями
            });
        });
    </script>
</body>
</html>
     
 